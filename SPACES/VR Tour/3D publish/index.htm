<!DOCTYPE html>
<html>
<head>
    <title>Untitled 3</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="initial-scale=1, width=device-width, viewport-fit=cover" />
    <link rel="preload" href="script.js?v=1771409390898" as="script"/>
<link rel="preload" href="media/panorama_6FBF5FF3_65CA_4849_41B7_91D4D9A87B08_0/l/1/0_0.jpg?v=1771409390898" as="image"/>
<link rel="preload" href="media/panorama_6FBF5FF3_65CA_4849_41B7_91D4D9A87B08_0/r/1/0_0.jpg?v=1771409390898" as="image"/>
<link rel="preload" href="media/panorama_6FBF5FF3_65CA_4849_41B7_91D4D9A87B08_0/u/1/0_0.jpg?v=1771409390898" as="image"/>
<link rel="preload" href="media/panorama_6FBF5FF3_65CA_4849_41B7_91D4D9A87B08_0/d/1/0_0.jpg?v=1771409390898" as="image"/>
<link rel="preload" href="media/panorama_6FBF5FF3_65CA_4849_41B7_91D4D9A87B08_0/f/1/0_0.jpg?v=1771409390898" as="image"/>
<link rel="preload" href="media/panorama_6FBF5FF3_65CA_4849_41B7_91D4D9A87B08_0/b/1/0_0.jpg?v=1771409390898" as="image"/>
<script>(function(i,s,o,g,r,a,m){i["GoogleAnalyticsObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,"script","//www.google-analytics.com/analytics.js","ga");ga("create", "UA-116087-3", "auto"); ga("send", "pageview");</script>
<meta name="description" content="Virtual Tour"/>
<meta name="theme-color" content="#FFFFFF"/>
    <script src="lib/tdvplayer.js?v=1771409390898"></script>
    <script type="text/javascript">
        var player;
        var playersPlayingTmp = [];
        var isInitialized = false;
        var isPaused = false;

        function loadTour()
        {
            if(player)
                return;

            var beginFunc = function(event){
                if(event.name == 'begin')
                {
                    var camera = event.data.source.get('camera');
                    if(camera && camera.get('initialSequence') && camera.get('initialSequence').get('movements').length > 0)
                        return;
                }

                if(event.sourceClassName == "MediaAudio")
                    return;

                isInitialized = true;

                player.unbind('preloadMediaShow', beginFunc, player, true);
                player.unbindOnObjectsOf('PanoramaPlayListItem', 'begin', beginFunc, player, true);
                player.unbind('stateChange', beginFunc, player, true);
                window.parent.postMessage("tourLoaded", '*');

                disposePreloader();

                onVirtualTourLoaded();
            };

            var settings = new TDV.PlayerSettings();
            
            settings.set(TDV.PlayerSettings.CONTAINER, document.getElementById('viewer'));
            settings.set(TDV.PlayerSettings.SCRIPT_URL, 'script.js?v=1771409390898');
            settings.set(TDV.PlayerSettings.WEBVR_POLYFILL_URL, 'lib/WebVRPolyfill.js?v=1771409390898');
            settings.set(TDV.PlayerSettings.HLS_URL, 'lib/Hls.js?v=1771409390898');
            settings.set(TDV.PlayerSettings.QUERY_STRING_PARAMETERS, 'v=1771409390898');
            window.tdvplayer = player = TDV.PlayerAPI.create(settings);
            player.bind('preloadMediaShow', beginFunc, player, true);
            player.bind('stateChange', beginFunc, player, true);
            player.bindOnObjectsOf('PanoramaPlayListItem', 'begin', beginFunc, player, true);
            player.bindOnObject('rootPlayer', 'start', function(e){
                var queryDict = {}; location.search.substr(1).split("&").forEach(function(item) {var k = item.split("=")[0], v = decodeURIComponent(item.split("=")[1]);queryDict[k] = v});
                var item = undefined;
                if("media-index" in queryDict){
                    item = setMediaByIndex(parseInt(queryDict["media-index"]) - 1);
                }
                else if("media-name" in queryDict){
                    item = setMediaByName(queryDict["media-name"]);
                }
                else{
                    item = setMediaByIndex(0);
                }
                if(item != undefined && "trigger-overlay-name" in queryDict){
                    triggerOverlayByName(item, queryDict["trigger-overlay-name"], "trigger-overlay-event" in queryDict ? queryDict["trigger-overlay-event"] : "click");
                }

                player.getById('rootPlayer').bind('tourEnded', function(){
                    onVirtualTourEnded();
                }, player, true);
            }, player, false);

            /* Listen messages */
            window.addEventListener('message', function (e) {
                //Listen to messages for make actions to player in the format function:param1,param2
                var action = e.data;
                if (action == 'pauseTour' || action == 'resumeTour') {
                    this[action].apply(this);
                }
            });
        }

        function pauseTour()
        {
            isPaused = true;
            if(!isInitialized)
                return;

            var playLists = player.getByClassName('PlayList');
            for(var i = 0, count = playLists.length; i<count; i++)
            {
                var playList = playLists[i];
                var index = playList.get('selectedIndex');
                if(index != -1)
                {
                    var item = playList.get('items')[index];
                    var itemPlayer = item.get('player');
                    if(itemPlayer && itemPlayer.pause)
                    {
                        playersPlayingTmp.push(itemPlayer);
                        itemPlayer.pause();
                    }
                }
            }

            player.getById('pauseGlobalAudios')();
        }

        function resumeTour()
        {
            isPaused = false;
            if(!isInitialized)
                return;

            while(playersPlayingTmp.length)
            {
                var viewer = playersPlayingTmp.pop();
                viewer.play();
            }

            player.getById('resumeGlobalAudios')();
        }

        function onVirtualTourLoaded()
        {
            if(isPaused)
                pauseTour();
        }

        function onVirtualTourEnded()
        {

        }

        function getRootPlayer()
        {
            return window.tdvplayer !== undefined ? window.tdvplayer.getById('rootPlayer') : undefined;
        }

        function setMediaByIndex(index)
        {
            var rootPlayer = getRootPlayer();
            if(rootPlayer !== undefined) {
                return rootPlayer.setMainMediaByIndex(index);
            }
        }

        function setMediaByName(name)
        {
            var rootPlayer = getRootPlayer();
            if(rootPlayer !== undefined) {
                return rootPlayer.setMainMediaByName(name);
            }
        }

        function triggerOverlayByName(item, name, eventName)
        {
            var rootPlayer = getRootPlayer();
            if(rootPlayer !== undefined) {
                item.bind('begin', function(e){
                    item.unbind('begin', arguments.callee, this);
                    var overlay = rootPlayer.getPanoramaOverlayByName(item.get('media'), name);
                    if(overlay)
                        rootPlayer.triggerOverlay(overlay, eventName);
                }, rootPlayer);
            }
        }

        function showPreloader()
        {
            var preloadContainer = document.getElementById('preloadContainer');
            if(preloadContainer != undefined)
                preloadContainer.style.opacity = 1;
        }

        function disposePreloader()
        {
            var preloadContainer = document.getElementById('preloadContainer');
            if(preloadContainer == undefined)
                return;

            var transitionEndName = transitionEndEventName();
            if(transitionEndName)
            {
                preloadContainer.addEventListener(transitionEndName, hide, false);
                preloadContainer.style.opacity = 0;
                setTimeout(hide, 500); //Force hide. Some cases the transitionend event isn't dispatched with an iFrame.
            }
            else
            {
                hide();
            }

            function hide()
            {
                
                preloadContainer.style.visibility = 'hidden';
                preloadContainer.style.display = 'none';
            }

            function transitionEndEventName () {
                var el = document.createElement('div');
                var transitions = {
                        'transition':'transitionend',
                        'OTransition':'otransitionend',
                        'MozTransition':'transitionend',
                        'WebkitTransition':'webkitTransitionEnd'
                    };

                var t;
                for (t in transitions) {
                    if (el.style[t] !== undefined) {
                        return transitions[t];
                    }
                }

                return undefined;
            }
        }

        function onBodyClick(){
            document.body.removeEventListener("click", onBodyClick);
            document.body.removeEventListener("touchend", onBodyClick);
            loadTour();
        }

        function onLoad() {
            if (/AppleWebKit/.test(navigator.userAgent) && /Mobile\/\w+/.test(navigator.userAgent))
            {
                var inIFrame = false;
                try
                {
                    inIFrame = (window.self !== window.top);
                }
                catch (e)
                {
                    inIFrame = true;
                }
                if (!inIFrame)
                {
                    var onResize = function(async)
                    {
                        [0, 250, 1000, 2000].forEach(function(delay)
                        {
                            setTimeout(function()
                            {
                                var viewer = document.querySelector('#viewer');
                                var scale = window.innerWidth / document.documentElement.clientWidth;
                                var width = document.documentElement.clientWidth;
                                var height = Math.round(window.innerHeight / scale);
                                viewer.style.width = width + 'px';
                                viewer.style.height = height + 'px';
                                viewer.style.left = Math.round((window.innerWidth - width) * 0.5) + 'px';
                                viewer.style.top = Math.round((window.innerHeight - height) * 0.5) + 'px';
                                viewer.style.transform = 'scale(' + scale + ', ' + scale + ')';
                                window.scrollTo(0,0);
                            }, delay);
                        });
                    };
                    window.addEventListener('resize', onResize);
                    onResize();
                }
            }


            if (isOVRWeb()){
                showPreloader();
                loadTour();
                return;
            }

            showPreloader();
loadTour()
        }

        function playVideo(video) {
            function isSafariDesktopV11orGreater() {
                return /^((?!chrome|android|crios|ipad|iphone).)*safari/i.test(navigator.userAgent) && parseFloat(/Version\/([0-9]+\.[0-9]+)/i.exec(navigator.userAgent)[1]) >= 11;
            }

            function detectUserAction() {
                var onVideoClick = function(e) {
                    if(video.paused) {
                        video.play();
                    }
                    video.muted = false;
                    e.stopPropagation();
                    e.stopImmediatePropagation();
                    e.preventDefault();
                    video.removeEventListener('click', onVideoClick);
                    video.removeEventListener('touchend', onVideoClick);
                };
                video.addEventListener("click", onVideoClick);
                video.addEventListener("touchend", onVideoClick);
            }

            if (isSafariDesktopV11orGreater()) {
                video.muted = true;
                video.play();
            } else {
                var canPlay = true;
                var promise = video.play();
                if (promise) {
                    promise.catch(function() {
                        video.muted = true;
                        video.play();
                        detectUserAction();
                    });
                } else {
                    canPlay = false;
                }

                if (!canPlay || video.muted) {
                    detectUserAction();
                }
            }
        }

        function isOVRWeb(){
            return window.location.hash.substring(1).split('&').indexOf('ovrweb') > -1;
        }

        function activateExperience(experienceId)
        {
            var title = document.getElementById('experienceTitle');
            var summary = document.getElementById('experienceSummary');
            var deck = document.getElementById('sessionDeck');
            var statuses = {
                world1a: {
                    title: 'WORLD-1a: Learning Room',
                    summary: 'Single host, immersive walkthrough, onboarding checkpoints, and gated access proof points.',
                    deck: 'Live flow: Host intro -> slide walkthrough -> audience checkpoint -> gated next room.'
                },
                socialHub: {
                    title: 'Social Hub: Clubhouse Mode',
                    summary: 'One host leads an interactive room while audience reacts, chats, and queues questions.',
                    deck: 'Live flow: Host stage -> audience listen mode -> raised-hand queue -> handoff.'
                },
                genesis: {
                    title: 'Genesis Terminal',
                    summary: 'Narrative terminal for ARG episodes and wallet-linked progression triggers.',
                    deck: 'Live flow: Story prompt -> user action -> collectible/progression update.'
                }
            };

            var selected = statuses[experienceId] || statuses.world1a;
            title.textContent = selected.title;
            summary.textContent = selected.summary;
            deck.textContent = selected.deck;

            Array.prototype.forEach.call(document.querySelectorAll('.chip'), function(chip){
                chip.classList.toggle('active', chip.getAttribute('data-experience') === experienceId);
            });
        }

        function setSessionMode(mode)
        {
            var modeText = document.getElementById('modeText');
            if(mode === 'host') {
                modeText.textContent = 'Host Mode: presentation controls prioritized, audience actions limited.';
                return;
            }
            if(mode === 'audience') {
                modeText.textContent = 'Audience Mode: lightweight UI, reactions and Q&A queue enabled.';
                return;
            }
            modeText.textContent = 'VR Mode: HUD minimized. Keep interactions gaze-friendly for headset pass.';
        }

        function toggleDock()
        {
            var dock = document.getElementById('controlDock');
            var toggle = document.getElementById('dockToggle');
            var presenter = document.getElementById('presenterCard');
            var collapsed = dock.classList.toggle('collapsed');
            presenter.classList.toggle('hidden', collapsed);
            toggle.textContent = collapsed ? 'Show Controls' : 'Hide Controls';
        }

        function setupPrototypeUI()
        {
            Array.prototype.forEach.call(document.querySelectorAll('.chip'), function(chip){
                chip.addEventListener('click', function(){
                    activateExperience(chip.getAttribute('data-experience'));
                });
            });

            activateExperience('world1a');
            setSessionMode('host');
            toggleDock();
        }
    </script>
    <style type="text/css">
        :root {
            --bg: #0a101c;
            --panel: rgba(10, 16, 28, 0.76);
            --panel-border: rgba(255, 255, 255, 0.2);
            --text: #f4f6fb;
            --muted: rgba(244, 246, 251, 0.72);
            --accent: #f5b942;
            --accent-soft: rgba(245, 185, 66, 0.2);
        }

        html, body {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            background: radial-gradient(circle at 18% 15%, #17263f 0%, var(--bg) 52%, #05070c 100%);
            color: var(--text);
            font-family: "Trebuchet MS", "Segoe UI", sans-serif;
            padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
        }

        #viewer {
            background-color: #101b30;
            z-index: 1;
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
        }

        #preloadContainer {
            z-index: 6;
            position: relative;
            width: 100%;
            height: 100%;
            transition: opacity 0.5s;
            -webkit-transition: opacity 0.5s;
            -moz-transition: opacity 0.5s;
            -o-transition: opacity 0.5s;
        }

        #uiLayer {
            position: absolute;
            inset: 0;
            z-index: 5;
            pointer-events: none;
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            gap: 16px;
            padding: 18px;
            box-sizing: border-box;
        }

        .control-dock, .presenter-card, #dockToggle {
            pointer-events: auto;
        }

        .control-dock {
            width: min(420px, 96vw);
            background: var(--panel);
            border: 1px solid var(--panel-border);
            border-radius: 18px;
            backdrop-filter: blur(12px);
            box-shadow: 0 14px 40px rgba(0, 0, 0, 0.34);
            padding: 16px;
            transition: transform 0.3s ease, opacity 0.3s ease;
        }

        .control-dock.collapsed {
            transform: translateX(calc(-100% - 12px));
            opacity: 0;
        }

        .brand {
            font-size: 1.2rem;
            font-weight: 700;
            letter-spacing: 0.05em;
        }

        .muted {
            color: var(--muted);
            margin-top: 6px;
            line-height: 1.35;
            font-size: 0.95rem;
        }

        .chips {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 14px;
        }

        .chip {
            border: 1px solid rgba(255, 255, 255, 0.25);
            background: rgba(255, 255, 255, 0.08);
            color: var(--text);
            border-radius: 999px;
            padding: 8px 12px;
            font-size: 0.85rem;
            cursor: pointer;
        }

        .chip.active {
            border-color: var(--accent);
            background: var(--accent-soft);
        }

        .section {
            margin-top: 14px;
            padding-top: 14px;
            border-top: 1px solid rgba(255, 255, 255, 0.16);
        }

        .section-title {
            margin: 0 0 8px 0;
            font-size: 0.82rem;
            letter-spacing: 0.12em;
            color: var(--muted);
            text-transform: uppercase;
        }

        .action-row {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .btn {
            border-radius: 999px;
            border: 0;
            padding: 8px 14px;
            cursor: pointer;
            font-weight: 600;
        }

        .btn-primary {
            background: var(--accent);
            color: #191102;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.14);
            color: var(--text);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        #modeText, #sessionDeck {
            margin: 8px 0 0;
            color: var(--muted);
            line-height: 1.35;
            font-size: 0.92rem;
        }

        #dockToggle {
            align-self: flex-start;
            border: 1px solid rgba(255, 255, 255, 0.3);
            background: rgba(10, 16, 28, 0.76);
            color: var(--text);
            border-radius: 999px;
            padding: 8px 12px;
            font-weight: 600;
            cursor: pointer;
            position: absolute;
            top: 14px;
            left: 14px;
        }

        .presenter-card {
            align-self: flex-end;
            width: min(460px, 98vw);
            background: linear-gradient(120deg, rgba(8, 13, 22, 0.85), rgba(36, 22, 7, 0.82));
            border: 1px solid rgba(245, 185, 66, 0.35);
            border-radius: 18px;
            padding: 14px;
            box-shadow: 0 12px 28px rgba(0, 0, 0, 0.35);
            transition: opacity 0.25s ease, transform 0.25s ease;
        }

        .presenter-card.hidden {
            opacity: 0;
            transform: translateY(16px);
            pointer-events: none;
        }

        .presenter-card h2 {
            margin: 0;
            font-size: 1.05rem;
        }

        .presenter-card p {
            margin: 6px 0 0;
            color: var(--muted);
            line-height: 1.35;
            font-size: 0.92rem;
        }

        elevenlabs-convai {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 7;
        }

        @media (max-width: 900px) {
            #uiLayer {
                padding: 10px;
                flex-direction: column;
                justify-content: flex-start;
            }

            .presenter-card {
                width: auto;
                margin-top: auto;
            }
        }
    </style>
    
</head>
<body onload="onLoad(); setupPrototypeUI();">
    <div id="preloadContainer" style="background-color:rgba(10,16,28,0.96)"><div style="z-index: 4; position: absolute; left: 0%; top: 50%; width: 100.00%; height: 10.00%"><div style="text-align:left; color:#f4f6fb;"><DIV STYLE="text-align:center;"><SPAN STYLE="letter-spacing:0.08em;color:#f4f6fb;font-size:1.39vmin;font-family:Trebuchet MS, Segoe UI, sans-serif;">Loading immersive node...</SPAN></DIV><p STYLE="margin:0; line-height:1.02vmin;"><BR STYLE="letter-spacing:0vmin;color:#000000;font-size:1.02vmin;font-family:Arial, Helvetica, sans-serif;"/></p></div></div></div>
    <div id="viewer"></div>
    <div id="uiLayer">
        <aside id="controlDock" class="control-dock">
            <div class="brand">Stacksverse PoC Console</div>
            <div id="experienceTitle" class="muted">WORLD-1a: Learning Room</div>
            <div id="experienceSummary" class="muted"></div>

            <div class="section">
                <p class="section-title">Experiences</p>
                <div class="chips">
                    <button class="chip active" data-experience="world1a">WORLD-1a</button>
                    <button class="chip" data-experience="socialHub">Social Hub</button>
                    <button class="chip" data-experience="genesis">Genesis Terminal</button>
                </div>
            </div>

            <div class="section">
                <p class="section-title">Session Mode</p>
                <div class="action-row">
                    <button class="btn btn-primary" onclick="setSessionMode('host')">Host</button>
                    <button class="btn btn-secondary" onclick="setSessionMode('audience')">Audience</button>
                    <button class="btn btn-secondary" onclick="setSessionMode('vr')">VR-Ready</button>
                </div>
                <p id="modeText"></p>
            </div>

            <div class="section">
                <p class="section-title">Presentation Flow</p>
                <p id="sessionDeck"></p>
            </div>
        </aside>

        <button id="dockToggle" onclick="toggleDock()">Hide Controls</button>

        <section id="presenterCard" class="presenter-card">
            <h2>Host Stage Overlay</h2>
            <p>Optimized for one host presenting a guided walkthrough with social clubhouse-style audience flow.</p>
            <p>VR constraint for next phase: keep CTA surfaces large, centered, and gaze-safe for headset interaction.</p>
        </section>
    </div>
    <elevenlabs-convai agent-id="agent_3401ka6nm1q0e0v98xyks0x9dyaq"></elevenlabs-convai>
    <script src="https://unpkg.com/@elevenlabs/convai-widget-embed" async type="text/javascript"></script>
</body>
</html>
